# Project Phoenix: System Architecture Document

**Version:** 2.0  
**Date:** December 18, 2025  
**Owner:** Cloud Engineering & Security (CISO Office)  
**Status:** Approved for Implementation

---

## Executive Summary

Project Phoenix is a **cloud-native, serverless-first platform** designed to deliver:
- **High Scalability**
- **Zero-Trust Security**
- **Cost-Efficiency**

The architecture utilizes:
- **AWS Lambda** for compute
- **Amazon CloudFront** for global content delivery
- **Segregated network design (VPC)** to protect data persistence layers

This document outlines the logical and physical architecture of the system as depicted in the v2 design.

---

## High-Level Architecture

The system is divided into **four primary layers**:

1. **Edge/Entry Layer** (Public Zone)
2. **Frontend Serving Layer** (Content Delivery Network)
3. **Compute/Backend Layer** (VPC Private Subnet)
4. **Data/Persistence Layer** (Private Subnet)

The architecture separates traffic for **Platform Users** and **App Users** to ensure granular control over caching and security policies.

---

## Architecture Component Breakdown

### 1. Edge & Entry Layer (Public Zone)

Traffic enters the system through a secure, globally distributed edge network.

#### Components:

**Amazon Route 53**
- Manages DNS resolution
- Routes Platform and App users to the nearest CloudFront entry points

**AWS WAF (Web Application Firewall)**
- Attached to CloudFront distributions
- Provides Layer 7 protection against:
  - SQL injection
  - XSS attacks
  - DDoS attacks

**Amazon Cognito**
- Manages authentication and user pools
- Provides identity tokens (JWT) required for users to access the API Gateway

---

### 2. Frontend Delivery (Content Delivery Network)

The architecture separates traffic for "Platform Users" and "App Users" to ensure granular control over caching and security policies.

#### Platform CloudFront CDN
- Serves the administrative interface
- Routes static assets from the `ui-platform` S3 bucket
- Routes dynamic API calls to the API Gateway

#### App CloudFront CDN
- Serves the end-user application
- Routes static assets from the `ui-renderer` S3 bucket
- Routes API calls to the API Gateway

---

### 3. Compute & Application Layer (VPC Private Subnet)

All business logic resides within a Virtual Private Cloud (VPC) to ensure isolation.

#### Components:

**Amazon API Gateway**
- Central entry point for all REST/WebSocket requests
- Acts as the "Front Door" for the backend
- Enforces throttling and validation before passing requests to Lambda

**App-Manager Lambda**
- Core compute unit running in a Private Subnet
- Serverless function executes business logic
- Processes requests from the API Gateway
- Isolated from the public internet for enhanced security

**VPC Interface Endpoints**
- Used to securely connect the Lambda function to AWS managed services
- Services include: Secrets Manager, CloudWatch
- Traffic does not traverse the public internet

---

### 4. Data & Persistence Layer (Private Subnet)

Data stores are strictly isolated within the Private Subnet, accessible only by the app-manager Lambda.

#### Components:

**Amazon RDS**
- Primary relational database (Aurora Serverless)
- Used for transactional data

**Amazon ElastiCache**
- Provides in-memory caching (Redis)
- Reduces database load
- Improves latency

**MongoDB Atlas**
- NoSQL store for unstructured data
- Connected securely via VPC Endpoints/Peering

**Jiffy-Drive (S3)**
- Used for storing large objects and user files
- Accessed via S3 Gateway Endpoint
- Keeps traffic within the AWS network

---

### 5. Networking & Egress

#### Public Subnet & NAT Gateway
- NAT Gateway placed in Public Subnet
- Allows Lambda functions in Private Subnet to access the internet
- Required for 3rd party API calls
- Prevents inbound connections

#### Private Subnet
- Hosts Lambda, RDS, and ElastiCache
- Ensures no direct public access
- Provides network isolation

---

## Security & Observability Stack

### Security & Governance

#### AWS Secrets Manager
- Securely stores database credentials and API keys
- Lambda function retrieves secrets at runtime
- Ensures no secrets are hardcoded

#### Amazon GuardDuty
- Provides intelligent threat detection
- Monitors VPC flow logs and DNS logs
- Detects malicious activity

#### AWS Security Hub
- Aggregates security alerts and compliance status
- Single dashboard for security overview

#### AWS AppConfig
- Manages dynamic configuration flags
- Allows feature toggles without redeploying code

---

### DevOps & Monitoring

#### Amazon ECR
- Stores container images for Lambda functions

#### AWS CodeArtifact
- Manages software packages (Maven/npm)
- Prevents dependency chain attacks

#### Amazon CloudWatch
- Collects logs and metrics from all services
- Services monitored: Lambda, API Gateway, RDS
- Used for monitoring and alerting

#### AWS X-Ray
- Provides distributed tracing
- Visualizes request flow: CloudFront → API Gateway → Lambda → Database
- Aids in debugging latency issues

---

## Design Decisions & Rationale

### 1. Dual CloudFront Distributions

**Decision:** Separate CloudFront distributions for Platform and App users

**Rationale:**
- Allows distinct caching policies
- Enables WAF rulesets tailored to internal vs. external traffic profiles
- Provides granular control over content delivery

---

### 2. Lambda in VPC

**Decision:** Place Lambda functions in VPC Private Subnet

**Rationale:**
- Necessary to access RDS and ElastiCache securely
- VPC Interface Endpoints reduce latency and cost
- Keeps AWS service traffic internal (no public internet)

---

### 3. S3 Gateway Endpoint

**Decision:** Utilize Gateway Endpoint for S3 (Jiffy-Drive)

**Rationale:**
- Avoids data processing charges associated with NAT Gateways
- Improves S3 transfer speeds
- Keeps traffic within AWS network

---

## Architecture Principles

### 1. Serverless-First Approach
- **AWS Lambda** for compute (no EC2 instances to manage)
- **Aurora Serverless** for database (auto-scaling)
- Pay only for what you use

### 2. Zero-Trust Security
- All compute in Private Subnets
- No direct public access to data stores
- Secrets managed securely (Secrets Manager)
- Network isolation at multiple layers

### 3. High Scalability
- CloudFront for global content delivery
- Lambda auto-scaling
- Aurora Serverless auto-scaling
- ElastiCache for performance

### 4. Cost-Efficiency
- Serverless pricing model
- VPC Endpoints to avoid NAT Gateway costs
- S3 Gateway Endpoint for efficient S3 access
- Pay-per-use model

---

## Traffic Flow

### Platform User Flow:
```
Platform User
    ↓
Route 53 (DNS)
    ↓
Platform CloudFront CDN
    ├── Static Assets → ui-platform S3 bucket
    └── API Calls → API Gateway
            ↓
        App-Manager Lambda (Private Subnet)
            ↓
        Data Stores (RDS, ElastiCache, MongoDB, S3)
```

### App User Flow:
```
App User
    ↓
Route 53 (DNS)
    ↓
App CloudFront CDN
    ├── Static Assets → ui-renderer S3 bucket
    └── API Calls → API Gateway
            ↓
        App-Manager Lambda (Private Subnet)
            ↓
        Data Stores (RDS, ElastiCache, MongoDB, S3)
```

---

## Security Layers

### Layer 1: Edge Security
- **AWS WAF** on CloudFront
- **Route 53** DNS protection
- **CloudFront** DDoS protection

### Layer 2: Authentication
- **Amazon Cognito** for identity management
- **JWT tokens** for API access
- User pools for Platform and App users

### Layer 3: Network Security
- **VPC** isolation
- **Private Subnets** for compute and data
- **Security Groups** for traffic control
- **NAT Gateway** for controlled egress

### Layer 4: Application Security
- **API Gateway** throttling and validation
- **Secrets Manager** for credential management
- **VPC Endpoints** for secure AWS service access

### Layer 5: Data Security
- **Encryption at rest** (RDS, S3, ElastiCache)
- **Encryption in transit** (TLS/SSL)
- **Private Subnet** isolation
- **No public internet access** to data stores

### Layer 6: Monitoring & Threat Detection
- **GuardDuty** for threat detection
- **Security Hub** for compliance
- **CloudWatch** for monitoring
- **X-Ray** for tracing

---

## Key Benefits

### Scalability
- ✅ Auto-scaling Lambda functions
- ✅ Aurora Serverless auto-scales database
- ✅ CloudFront global distribution
- ✅ ElastiCache for performance

### Security
- ✅ Zero-trust architecture
- ✅ Network isolation (VPC)
- ✅ Secrets management
- ✅ Threat detection (GuardDuty)
- ✅ WAF protection

### Cost-Efficiency
- ✅ Serverless pricing (pay per use)
- ✅ No idle resources
- ✅ VPC Endpoints reduce costs
- ✅ S3 Gateway Endpoint efficiency

### Operational Excellence
- ✅ No infrastructure management
- ✅ Automated scaling
- ✅ Centralized monitoring (CloudWatch)
- ✅ Distributed tracing (X-Ray)
- ✅ Feature flags (AppConfig)

---

## Technology Stack Summary

### Compute
- **AWS Lambda** (Serverless functions)

### Content Delivery
- **Amazon CloudFront** (CDN)

### API Management
- **Amazon API Gateway** (REST/WebSocket)

### Databases
- **Amazon RDS Aurora Serverless** (Relational)
- **Amazon ElastiCache Redis** (Caching)
- **MongoDB Atlas** (NoSQL)

### Storage
- **Amazon S3** (Jiffy-Drive - Object storage)

### Networking
- **Amazon VPC** (Network isolation)
- **VPC Interface Endpoints** (AWS services)
- **S3 Gateway Endpoint** (S3 access)
- **NAT Gateway** (Internet egress)

### Security
- **AWS WAF** (Web Application Firewall)
- **Amazon Cognito** (Authentication)
- **AWS Secrets Manager** (Secrets)
- **Amazon GuardDuty** (Threat detection)
- **AWS Security Hub** (Security aggregation)

### DevOps & Monitoring
- **Amazon ECR** (Container registry)
- **AWS CodeArtifact** (Package management)
- **Amazon CloudWatch** (Logs & Metrics)
- **AWS X-Ray** (Distributed tracing)
- **AWS AppConfig** (Configuration management)

### DNS
- **Amazon Route 53** (DNS management)

---

## Architecture Diagram Reference

The architecture diagram (Phoenix - Current architecture v2 (1).jpeg) illustrates:
- Separation of concerns between Platform and App users
- Edge security layer
- Private compute logic
- Data persistence layer isolation

---

## Implementation Status

**Status:** Approved for Implementation  
**Version:** 2.0  
**Date:** December 18, 2025

---

## Notes

- All components follow AWS Well-Architected Framework principles
- Architecture supports multi-region deployment (future enhancement)
- Designed for high availability and disaster recovery
- Compliant with security and compliance requirements
- Cost-optimized for serverless workloads

